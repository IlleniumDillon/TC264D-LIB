# HSIC—TC264D底层库

## 文件结构

|  文件夹  |                             内容                             |
| :------: | :----------------------------------------------------------: |
| SmartCar | 根据ILLD编写的各种硬件接口、通信和中断等的驱动程序。目前包括：ADC、CCU6定时器、AB相编码器、外部中断、DFLASH、GPIO、软硬件IIC、PWM输出、系统时钟模块、软硬件SPI、UART |
|  Tools   | 工具类。目前包括：日志库、矩阵运算库、数字滤波器库、传递函数库 |
|  Driver  |                          外设驱动。                          |
|   User   |                   用户自行编写的库函数等。                   |

## 相较逐飞提供的底层库的改动

### ADC

允许使用第3通道的引脚，增加12个可配置的ADC引脚。

简化初始化流程，避免同一通道重复初始化。

默认使用最高分辨率（12位）。

### CCU6定时器

简化CCU6模块基地址寻址方式。

定时器的响应核可以在初始化时配置。

### AB相编码器

可配置Z相的使用。

可配置正反转方向。

优化转速获得方法，使用硬件MT法测速和硬件数值滤波，可以同时获得绝对转角和转速。

### 外部中断

外部中断响应核可在初始化时配置。

### DFLASH

增加按DFLASH地址读取数据的方法，可能简化菜单。

### GPIO

优化端口寻址方式。

使用内联函数可能提高性能。

### 硬件IIC

可在运行时更改从机设备地址，支持一主多从。

### 软件IIC

使用设备结构体实现IIC通信，可以使用多组软件IIC引脚。

### PWM输出

增加运行时对频率的修改。

### 系统时钟模块

优化系统时钟模块的寻址方式。

新增4个系统时钟定时器中断，与CCU6的定时器独立。

### 硬件SPI

优化初始化流程，避免SPI通道重复初始化。

支持一主多从。

### 软件SPI

使用设备配置结构体，可以使用多组软件SPI引脚。

### UART

UART中断响应核可在初始化时配置。

### 中断服务函数

使用虚函数定义中断服务函数，可以简化代码包含关系。



